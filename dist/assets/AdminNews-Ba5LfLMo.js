import{b as f,c as v,r as o,d as b,j as e,g as N,a as k,u as F}from"./index-Kw8xKDi7.js";import{L as w,M as S}from"./Loading-DQS1gP-0.js";import"./loading-DzfRIQr3.js";const q="/api";function y({onClose:u}){const[m,x]=f("auth_token",""),g=v(),[i,n]=o.useState(!1),h=b(),[c,p]=o.useState(""),j=a=>{const l=a.target.files[0];if(l){const t=new FileReader;t.onloadend=()=>{p(t.result)},t.readAsDataURL(l)}},r=async a=>{a.preventDefault(),n(!0);try{const l=await fetch(q+"/news",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify({image:c,title_ru:a.target.title_ru.value,title_en:a.target.title_en.value,title_tj:a.target.title_tj.value,desc_ru:a.target.desc_ru.value,desc_en:a.target.desc_en.value,desc_tj:a.target.desc_tj.value,created_at:a.target.created_at.value,order_number:a.target.order_number.value,is_active:a.target.is_active.checked})});l.status==403&&(x(""),g("/login"));const t=await l.json();n(!1),u(),l.ok&&h(N())}catch(l){n(!1),u(),console.log(l)}};return e.jsxs("form",{className:"form-container",onSubmit:a=>r(a),children:[i&&e.jsx(w,{}),e.jsx("h2",{children:"Добавить новость"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"image",children:"Изображение"}),e.jsx("input",{type:"file",id:"image",name:"image",accept:"image/*",onChange:j,required:!0}),e.jsx("br",{}),e.jsx("div",{children:c&&e.jsx("img",{src:c,alt:"",style:{height:"200px",width:"300px","object-fit":"contain"}})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title_ru",children:"Заголовок (RU)"}),e.jsx("input",{type:"text",id:"title_ru",name:"title_ru",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title_en",children:"Заголовок (EN)"}),e.jsx("input",{type:"text",id:"title_en",name:"title_en",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title_tj",children:"Заголовок (TJ)"}),e.jsx("input",{type:"text",id:"title_tj",name:"title_tj",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"created_at",children:"Дата публикаця"}),e.jsx("input",{type:"datetime-local",id:"created_at",name:"created_at",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_ru",children:"Описание (RU)"}),e.jsx("textarea",{id:"desc_ru",name:"desc_ru",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_en",children:"Описание (EN)"}),e.jsx("textarea",{id:"desc_en",name:"desc_en",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_tj",children:"Описание (TJ)"}),e.jsx("textarea",{id:"desc_tj",name:"desc_tj",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"order_number",children:"Порядковый номер"}),e.jsx("input",{type:"number",id:"order_number",name:"order_number",min:"1",defaultValue:1,required:!0})]}),e.jsxs("div",{className:"form-group checkbox",children:[e.jsx("input",{type:"checkbox",id:"is_active",name:"is_active"}),e.jsx("label",{htmlFor:"is_active",children:"Активна"})]}),e.jsx("div",{className:"form-group",children:e.jsx("button",{type:"submit",children:"Сохранить"})})]})}const C="/api";function L({id:u,onClose:m}){const x=v(),[g,i]=o.useState(!1),[n,h]=o.useState(""),[c,p]=f("auth_token",""),j=b(),r=k(t=>t.news.data.data).filter(t=>t.id==u),a=t=>{const d=t.target.files[0];if(d){const s=new FileReader;s.onloadend=()=>{h(s.result)},s.readAsDataURL(d)}},l=async t=>{t.preventDefault(),i(!0);try{const d=await fetch(C+"/news/"+u,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({image:n.length>0?n:r[0].image,title_ru:t.target.title_ru.value,title_en:t.target.title_en.value,title_tj:t.target.title_tj.value,desc_ru:t.target.desc_ru.value,desc_en:t.target.desc_en.value,desc_tj:t.target.desc_tj.value,created_at:t.target.created_at.value,order_number:t.target.order_number.value,is_active:t.target.is_active.checked})});console.log(d),d.status==403&&(p(""),x("/login"));const s=await d.json();i(!1),m(),d.ok&&j(N())}catch(d){i(!1),console.log(d.status)}};return o.useEffect(()=>()=>{i(!1),h("")},[]),e.jsxs("div",{className:"container_add_slider",children:[g&&e.jsx(w,{}),e.jsx("h1",{children:"Изменить новость"}),e.jsxs("form",{id:"newsForm editSlider",style:{alignContent:"center",justifyContent:"center",flexWrap:"column",flexDirection:"column",gap:"20px",alignItems:"center"},onSubmit:t=>l(t),children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"image",children:"Изображение"}),e.jsx("input",{type:"file",id:"image",name:"image",accept:"image/*",onChange:a}),e.jsx("br",{}),e.jsx("div",{children:n.length>0?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:n,alt:"",style:{height:"200px",width:"300px","object-fit":"contain"}}),e.jsx("button",{onClick:()=>h(""),children:"X"})]}):e.jsx("img",{src:r[0].image,alt:"",style:{height:"200px",width:"300px","object-fit":"contain"}})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description-ru",children:"Заголовок (RU)"}),e.jsx("textarea",{id:"description-ru",name:"title_ru",defaultValue:r[0].title_ru,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title_en",children:"Заголовок (EN)"}),e.jsx("textarea",{id:"description-en",name:"title_en",defaultValue:r[0].title_en,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description-tj",children:"Заголовок (TJ)"}),e.jsx("textarea",{id:"description-tj",name:"title_tj",defaultValue:r[0].title_tj,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description-ru",children:"Дата публикаця"}),e.jsx("input",{type:"datetime-local",id:"created_at",name:"created_at",defaultValue:new Date(r[0].created_at).toISOString().slice(0,16),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_ru",children:"Описание (RU)"}),e.jsx("textarea",{id:"desc_ru",name:"desc_ru",defaultValue:r[0].desc_ru,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_en",children:"Описание (EN)"}),e.jsx("textarea",{id:"desc_en",name:"desc_en",defaultValue:r[0].desc_en,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"desc_tj",children:"Описание (TJ)"}),e.jsx("textarea",{id:"desc_tj",name:"desc_tj",defaultValue:r[0].desc_tj,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"number",children:"Порядковый номер"}),e.jsx("input",{type:"number",id:"number",name:"order_number",min:"1",defaultValue:r[0].order_number,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"number",children:"Активна"}),e.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",defaultChecked:r[0].is_active,required:!0})]}),e.jsx("br",{}),e.jsx("div",{children:e.jsx("button",{type:"submit",children:"Сохранить"})})]})]})}const I="/api";function R(){const[u,m]=o.useState(!1),[x,g]=o.useState(0);f("language","ru");const[i,n]=o.useState(!1),[h,c]=o.useState(!1),{t:p}=F(),j=k(s=>s.news.data.data),[r,a]=f("auth_token",""),l=b();v();const t=async s=>{m(!0);try{const _=await fetch(I+"/news/"+s,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}}),T=await _.json();m(!1),_.ok&&l(N())}catch(_){m(!1),console.log(_)}},d=s=>{g(s),c(!0)};return j?e.jsx(e.Fragment,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{className:"news-container",children:j.map(s=>e.jsxs("div",{className:"news-card",children:[e.jsx("img",{src:s.image,alt:"Новость 1"}),e.jsxs("div",{className:"news-content",children:[e.jsx("div",{className:"news-label",style:{fontSize:"20px"},children:s.is_active?"Активнен":"Неактивен"}),e.jsx("div",{className:"news-title",children:e.jsx("p",{children:s["title_"+localStorage.getItem("language")||"ru"]})}),e.jsx("div",{className:"news-date",children:new Date(s.created_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("div",{className:"news-text",children:s["desc_"+localStorage.getItem("language")||"ru"]})]}),e.jsxs("div",{className:"admin_news_btn action-buttons",children:[e.jsxs("button",{className:"btn btn-edit",onClick:()=>d(s.id),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-6-6l6 6m0 0L10.5 21H6v-4.5L17 5z"})}),"Изменить"]}),e.jsxs("button",{className:"btn btn-delete",onClick:()=>t(s.id),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-3h4a1 1 0 011 1v1H9V5a1 1 0 011-1z"})}),"Удалить"]})]})]},s.id))}),u&&e.jsx(w,{}),e.jsx(S,{isOpen:h,onClose:()=>c(!1),children:e.jsx(L,{id:x,onClose:()=>c(!1)})}),e.jsxs("div",{className:"container_add",children:[e.jsx("button",{className:"add-button",title:"Добавить новость",onClick:()=>n(!i),children:i?"X":"+"}),e.jsx("h1",{children:i?"Закыть окно добавление":"Добавить новое запис"})]}),i&&e.jsx(y,{onClose:()=>n(!1)})]})}):e.jsxs(e.Fragment,{children:[i&&e.jsx(y,{onClose:()=>n(!1)}),e.jsxs("div",{className:"container_add",children:[e.jsx("button",{className:"add-button",title:"Добавить новость",onClick:()=>setOpen(!0),children:"+"}),e.jsx("h1",{children:"Добавить новое запис"})]})]})}export{R as default};
